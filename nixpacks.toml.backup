# Nixpacks configuration for FlipOps Site
# This ensures Railway runs Next.js in server mode, not static export mode

[phases.setup]
nixPkgs = ["nodejs_22"]

[phases.install]
cmds = ["npm ci --include=dev"]

[phases.build]
cmds = [
  "npm run build",
  "cp -r .next/static .next/standalone/flipops-site/.next/",
  "cp -r public .next/standalone/flipops-site/"
]

[start]
# Use standalone server for better static asset handling
cmd = "node .next/standalone/flipops-site/server.js"
